# Boas vindas ao reposit√≥rio do projeto One For All!


# Entreg√°veis

<details>
  <summary><strong>üë®‚Äçüíª O que dever√° ser desenvolvido</strong></summary><br />

Hoje, no projeto ***One For All***, voc√™ usar√° **uma** tabela para revisar e consolidar **todos** os principais conceitos vistos at√© o momento.

Voc√™ receber√° uma tabela n√£o normalizada que dever√° ser normalizada e populada para que voc√™ possa executar queries com o intuito de encontrar as informa√ß√µes solicitadas.

## Desenvolvimento

Normalize uma tabela na terceira forma normal e acesse as informa√ß√µes desta tabela atrav√©s de `queries` utilizando `SQL`.

</details>

## Orienta√ß√µes

<details>
  <summary><strong>:whale: Rodando no Docker vs Localmente</strong></summary><br />
  
  ## Com Docker
 
  > Rode os servi√ßos `node` e `db` com o comando `docker-compose up -d`.
  - Lembre-se de parar o `mysql` se estiver usando localmente na porta padr√£o (`3306`), ou adapte, caso queria fazer uso da aplica√ß√£o em containers
  - Esses servi√ßos ir√£o inicializar um container chamado `one_for_all` e outro chamado `one_for_all_db`.
  - A partir daqui voc√™ pode rodar o container `one_for_all` via CLI ou abri-lo no VS Code.

  > Use o comando `docker exec -it one_for_all bash`.
  - Ele te dar√° acesso ao terminal interativo do container criado pelo compose, que est√° rodando em segundo plano;
  - As credencias de acesso ao banco de dados est√£o definidas no arquivo `docker-compose.yml`, e s√£o acess√≠veis no container atrav√©s das vari√°veis de ambiente `MYSQL_USER` e `MYSQL_PASSWORD`. üí°

  > Instale as depend√™ncias [**Caso existam**] com `npm install`
  
  ‚ö† Aten√ß√£o ‚ö† Caso opte por utilizar o Docker, **TODOS** os comandos dispon√≠veis no `package.json` (npm start, npm test, npm run dev, ...) devem ser executados **DENTRO** do container, ou seja, no terminal que aparece ap√≥s a execu√ß√£o do comando `docker exec` citado acima. 

  ‚ö† Aten√ß√£o ‚ö† O **git** dentro do container n√£o vem configurado com suas credenciais. Ou fa√ßa os commits fora do container, ou configure as suas credenciais do git dentro do container.

  ‚ö† Aten√ß√£o ‚ö† N√£o rode o comando npm audit fix! Ele atualiza v√°rias depend√™ncias do projeto, e essa atualiza√ß√£o gera conflitos com o avaliador.


‚ú® **Dica:** A extens√£o `Remote - Containers` (que estar√° na se√ß√£o de extens√µes recomendadas do VS Code) √© indicada para que voc√™ possa desenvolver sua aplica√ß√£o no container Docker direto no VS Code, como voc√™ faz com seus arquivos locais.

<img src="images/remote-container.png" width="800px" >

 :warning: Aten√ß√£o :warning: Para que voc√™ consiga rodar o seu projeto com docker e o avaliador funcione √© fundamental que o seu docker compose esteja na **vers√£o 1.29** 
 primeiro verifique sua vers√£o 
 > docker-compose --version

 Se n√£o for a vers√£o 1.29, fa√ßa os seguintes comandos para atualizar a vers√£o:
 
 >sudo rm /usr/local/bin/docker-compose

 >sudo curl -L "https://github.com/docker/compose/releases/download/1.29.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

 >sudo chmod +x /usr/local/bin/docker-compose


---
  
  ## Sem Docker
  
  
  > Instale as depend√™ncias [**Caso existam**] com `npm install`
  
  ‚ö† Aten√ß√£o ‚ö† N√£o rode o comando npm audit fix! Ele atualiza v√°rias depend√™ncias do projeto, e essa atualiza√ß√£o gera conflitos com o avaliador.

  ‚ú® **Dica:** Para rodar o projeto desta forma, obrigatoriamente voc√™ deve ter o `node` instalado em seu computador.
  ‚ú® **Dica:** O avaliador espera que a vers√£o do `node` utilizada seja a 16.

  <br/>
</details>

<details>
  <summary><strong>üéØ Problema a ser resolvido</strong></summary><br />


Voc√™ receber√° uma tabela n√£o normalizada semelhante ao que poderia ser uma vers√£o simplificada do banco de dados do Spotify. O trabalho consistir√° de duas partes:

1. Normalizar essa tabela, criar o schema no seu banco de dados local e popul√°-lo;

2. Realizar os desafios no seu banco normalizado e populado.

## Normalize as tabelas para a 3¬™ Forma Normal

Antes de tudo, voc√™ dever√° modelar e normalizar essas tabelas para a 3¬∞ Forma Normal. Monte quantas planilhas e tabelas forem necess√°rias para criar essa vers√£o normalizada desde que voc√™ siga as regras de neg√≥cio. N√£o √© necess√°rio criar o c√≥digo SQL neste momento.

Seu banco de dados deve seguir as regras de neg√≥cio e ser capaz de recuperar:

* Informa√ß√µes sobre quais planos est√£o dispon√≠veis e seus detalhes;
  * Cada pessoa usu√°ria pode possuir apenas um plano.

* Informa√ß√µes sobre todas as pessoas artistas;
  * Uma pessoa artista pode ter v√°rios √°lbuns;
  * Uma pessoa artista pode ser seguida por v√°rias pessoas usu√°rias.

* Informa√ß√µes sobre todos os √°lbuns de cada artista;
  * Para fins deste projeto, considere que cada √°lbum possui apenas uma pessoa artista como principal;
  * Cada √°lbum possui v√°rias can√ß√µes.

* Informa√ß√µes sobre todas as can√ß√µes de cada √°lbum;
  * Para fins deste projeto, considere que cada can√ß√£o est√° contida em apenas um √°lbum.

* Informa√ß√µes sobre todas as pessoas usu√°rias, seus planos, seu hist√≥rico de reprodu√ß√£o e pessoas artistas seguidas.
  * Uma pessoa usu√°ria pode possuir apenas um plano;
  * Cada m√∫sica do hist√≥rico de reprodu√ß√£o pode aparecer uma √∫nica vez por pessoa (para simplificar, considere que o objetivo do hist√≥rico √© saber **quais** can√ß√µes j√° foram reproduzidas e **n√£o quantas vezes** foram reproduzidas);
  * Uma pessoa usu√°ria pode seguir v√°rias pessoas artistas, mas cada pessoa artista pode ser seguida apenas uma vez por pessoa usu√°ria.

</details>

# Requisitos do projeto

## Desafio 1

* Crie um banco com o nome de **`SpotifyClone`**.

* Providencie as queries necess√°rias para criar tabelas normalizadas que atendam aos requisitos descritos na se√ß√£o anterior;

* Providencie as queries necess√°rias para popular as tabelas de acordo com os dados listados na se√ß√£o anterior;

* Crie um arquivo de configura√ß√µes `desafio1.json`, que mapear√° em qual tabela e coluna se encontram as informa√ß√µes necess√°rias para a avalia√ß√£o automatizada deste desafio. 

<details>
  <summary><strong>üëá As configura√ß√µes devem possuir o seguinte formato</strong></summary><br />

  ```json
  {
    "coluna_usuario": "nome-da-coluna",
    "tabela_que_contem_usuario": "nome-da-tabela-que-armazena-a-coluna",
    "coluna_plano": "nome-da-coluna",
    "tabela_que_contem_plano": "nome-da-tabela-que-armazena-a-coluna",
    "coluna_historico_de_reproducoes": "nome-da-coluna",
    "tabela_que_contem_historico_de_reproducoes": "nome-da-tabela-que-armazena-a-coluna",
    "coluna_seguindo_artistas": "nome-da-coluna",
    "tabela_que_contem_seguindo_artistas": "nome-da-tabela-que-armazena-a-coluna",
    "coluna_artista": "nome-da-coluna",
    "tabela_que_contem_artista": "nome-da-tabela-que-armazena-a-coluna",
    "coluna_album": "nome-da-coluna",
    "tabela_que_contem_album": "nome-da-tabela-que-armazena-a-coluna",
    "coluna_cancoes": "nome-da-coluna",
    "tabela_que_contem_cancoes": "nome-da-tabela-que-armazena-a-coluna"
  }
  ```

  Essa configura√ß√£o deve ser feita baseada no seu banco de dados **ap√≥s a normaliza√ß√£o**. Ou seja, se voc√™ criou uma tabela chamada `users` que possui a coluna `name`, voc√™ substituiria `"coluna_usuario"` e `"tabela_que_contem_usuario"` da seguinte forma:

  ```json
  {
    "coluna_usuario": "name",
    "tabela_que_contem_usuario": "users",
    ...
  }
  ```

</details>

* Salve as queries criadas no arquivo `desafio1.sql`.

<details>
<summary><strong>üëá Seu c√≥digo dever√° ser similar ao seguinte</strong></summary><br />

  ```sql
  DROP DATABASE IF EXISTS SpotifyClone;

  CREATE DATABASE SpotifyClone;

  CREATE TABLE SpotifyClone.tabela1(
      coluna1 tipo restricoes,
      coluna2 tipo restricoes,
      colunaN tipo restricoes,
  ) engine = InnoDB;

  CREATE TABLE SpotifyClone.tabela2(
      coluna1 tipo restricoes,
      coluna2 tipo restricoes,
      colunaN tipo restricoes,
  ) engine = InnoDB;

  INSERT INTO SpotifyClone.tabela1 (coluna1, coluna2)
  VALUES
    ('exemplo de dados 1', 'exemplo de dados A'),
    ('exemplo de dados 2', 'exemplo de dados B'),
    ('exemplo de dados 3', 'exemplo de dados C');

  INSERT INTO SpotifyClone.tabela2 (coluna1, coluna2)
  VALUES
    ('exemplo de dados 1', 'exemplo de dados X'),
    ('exemplo de dados 2', 'exemplo de dados Y');
  ```

</details>

<details>
<summary><strong>‚òëÔ∏è O que ser√° verificado</strong></summary><br />

  - Ser√° validado se os planos est√£o na tabela normalizada.

  - Ser√° validado se o hist√≥rico de reprodu√ß√£o est√° na tabela normalizada.

  - Ser√° validado se as informa√ß√µes sobre pessoas seguindo artistas est√£o na tabela normalizada.

  - Ser√° validado se os √°lbuns est√£o na tabela normalizada.

  - Ser√° validado se as can√ß√µes est√£o na tabela normalizada.

  - Ser√° validado se as informa√ß√µes sobre pessoas usu√°rias est√£o na tabela normalizada.

  - Ser√° validado se as informa√ß√µes sobre artistas est√£o na tabela normalizada.

  ‚ö†Ô∏è Note que uma vez executado um teste, a sua base de dados `SpotifyClone` **ser√° dropada**. Logo, **se atente** a salvar seu progresso nos arquivos de desafio! ‚ö†Ô∏è
 
</details>

## Desafio 2

Crie uma `QUERY` que exiba tr√™s colunas:

1. A primeira coluna deve exibir a quantidade total de can√ß√µes. D√™ a essa coluna o alias "**cancoes**".

2. A segunda coluna deve exibir a quantidade total de artistas e dever√° ter o alias "**artistas**".

3. A terceira coluna deve exibir a quantidade de √°lbuns e dever√° ter o alias "**albuns**".

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:


O que ser√° verificado:

- Ser√° validado se existe uma `QUERY` que exibe os dados corretos nas colunas `cancoes`, `artistas` e `albuns`.

</details>

## Desafio 3

Crie uma `QUERY` que dever√° ter apenas tr√™s colunas:

1. A primeira coluna deve possuir o alias "**usuario**" e exibir o nome da pessoa usu√°ria.

2. A segunda coluna deve possuir o alias "**qtde_musicas_ouvidas**" e exibir a quantidade de m√∫sicas ouvida pela pessoa com base no seu hist√≥rico de reprodu√ß√£o.

3. A terceira coluna deve possuir o alias "**total_minutos**" e exibir a soma dos minutos ouvidos pela pessoa usu√°ria com base no seu hist√≥rico de reprodu√ß√£o.

Os resultados devem estar agrupados pelo nome da pessoa usu√°ria e ordenados em ordem alfab√©tica.

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:


O que ser√° verificado:

- Ser√° validado se existe uma `QUERY` que exibe os dados corretos nas colunas `usuario`, `qtde_musicas_ouvidas` e `total_minutos`.

- Ser√° validado se as colunas est√£o ordenadas de forma correta.

</details>

## Desafio 4

Crie uma `QUERY` que deve mostrar as pessoas usu√°rias que estavam ativas no ano de **2021** se baseando na data mais recente no hist√≥rico de reprodu√ß√£o.

1. A primeira coluna deve possuir o alias "**usuario**" e exibir o nome da pessoa usu√°ria.

2. A segunda coluna deve ter o alias "**condicao_usuario**" e exibir se a pessoa usu√°ria est√° ativa ou inativa.

O resultado deve estar ordenado em ordem alfab√©tica.

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:

O que ser√° verificado:

- Ser√° validado se existe uma `QUERY` que exibe os dados corretos nas colunas `usuario` e `condicao_usuario`.

- Ser√° validado se as colunas est√£o ordenadas de forma correta.

</details>

## Desafio 5

Estamos fazendo um estudo das m√∫sicas mais tocadas e precisamos saber quais s√£o as duas m√∫sicas mais tocadas no momento. Crie uma `QUERY` que possua duas colunas:

1. A primeira coluna deve possuir o alias "**cancao**" e exibir o nome da can√ß√£o.

2. A segunda coluna deve possuir o alias "**reproducoes**" e exibir a quantidade de pessoas que j√° escutaram a can√ß√£o em quest√£o.

Seu resultado deve estar ordenado em ordem decrescente, baseando-se no n√∫mero de reprodu√ß√µes. Em caso de empate, ordene os resultados pelo nome da can√ß√£o em ordem alfab√©tica. Queremos apenas o top 2 de m√∫sicas mais tocadas.

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:


O que ser√° verificado:

- Ser√° validado se existe uma `QUERY` que exibe os dados corretos nas colunas `cancao` e `reproducoes`.

- Ser√° validado se as colunas est√£o ordenadas de forma correta.

</details>

## Desafio 6

Tendo como base o valor dos planos e o plano que cada pessoa usu√°ria cadastrada possui no banco, queremos algumas informa√ß√µes sobre o faturamento da empresa. Crie uma `QUERY` que deve exibir quatro dados:

1. A primeira coluna deve ter o alias "**faturamento_minimo**" e exibir o menor valor de plano existente para uma pessoa usu√°ria.

2. A segunda coluna deve ter o alias "**faturamento_maximo**" e exibir o maior valor de plano existente para uma pessoa usu√°ria.

3. A terceira coluna deve ter o alias "**faturamento_medio**" e exibir o valor m√©dio dos planos possu√≠dos por pessoas usu√°rias at√© o momento.

4. Por fim, a quarta coluna deve ter o alias "**faturamento_total**" e exibir o valor total obtido com os planos possu√≠dos por pessoas usu√°rias.

Para cada um desses dados, por se tratarem de valores monet√°rios, deve-se arredondar o faturamento usando apenas duas casas decimais.

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:

O que ser√° verificado:

- Ser√° validado se existe uma `QUERY` que exibe os dados corretos nas colunas `faturamento_minimo`, `faturamento_maximo`, `faturamento_medio` e `faturamento_total`.

</details>

## Desafio 7

Mostre uma rela√ß√£o de todos os √°lbuns produzidos por cada pessoa artista, com a quantidade de seguidores que ela possui, de acordo com os detalhes a seguir. Para tal, crie uma `QUERY` com as seguintes colunas:

1. A primeira coluna deve exibir o nome da pessoa artista, com o alias "**artista**".

2. A segunda coluna deve exibir o nome do √°lbum, com o alias "**album**".

3. A terceira coluna deve exibir a quantidade de pessoas seguidoras que aquela pessoa artista possui e deve possuir o alias "**seguidores**".

Seus resultados devem estar ordenados de forma decrescente, baseando-se no n√∫mero de pessoas seguidoras. Em caso de empate no n√∫mero de pessoas, ordene os resultados pelo nome da pessoa artista em ordem alfab√©tica e caso h√° artistas com o mesmo nome, ordene os resultados pelo nome do √°lbum alfabeticamente.

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:

O que ser√° verificado:

- Ser√° validado se existe uma `QUERY` que exibe os dados corretos nas colunas `artista`, `album` e `seguidores`.

- Ser√° validado se as colunas est√£o ordenadas de forma correta.

</details>

## Desafio 8

Mostre uma rela√ß√£o dos √°lbuns produzidos por um artista espec√≠fico, neste caso `"Walter Phoenix"`.
Para isto crie uma `QUERY` que o retorno deve exibir as seguintes colunas:

1. O nome da pessoa artista, com o alias "**artista**".

2. O nome do √°lbum, com o alias "**album**".

Os resultados devem ser ordenados pelo nome do √°lbum em ordem alfab√©tica.

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:

O que ser√° verificado:

- Ser√° validado se a `QUERY` retorna a coluna `artista` contendo o nome da pessoa artista e a coluna `album` contendo o nome do √°lbum.

- Ser√° validado se as colunas est√£o ordenadas de forma correta.

</details>

## Desafio 9

Crie uma `QUERY` que exibe a quantidade de m√∫sicas que est√£o presentes atualmente no hist√≥rico de reprodu√ß√£o de uma pessoa usu√°ria espec√≠fica. Para este caso queremos saber quantas m√∫sicas est√£o no hist√≥rico do usu√°rio `"Bill"` e a consulta deve retornar a seguinte coluna:

1. O valor da quantidade, com o alias "**quantidade_musicas_no_historico**".

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />

Sua `QUERY` deve retornar a seguinte informa√ß√£o:


O que ser√° verificado:

- Ser√° validado se a `QUERY` retorna a quantidade correta de can√ß√µes presentes no hist√≥rico de reprodu√ß√£o da pessoa especificada.

</details>

## Desafio 10

Crie uma `QUERY` que exiba o nome e a quantidade de vezes que cada can√ß√£o foi tocada por pessoas usu√°rias do plano gratuito ou pessoal de acordo com os detalhes a seguir:

* A primeira coluna deve exibir o nome da can√ß√£o, com o alias "**nome**";

* A segunda coluna deve exibir a quantidade de pessoas que j√° escutaram aquela can√ß√£o, com o alias "**reproducoes**";

* Seus resultados devem estar agrupados pelo nome da can√ß√£o e ordenados em ordem alfab√©tica.

<details>
  <summary><strong>‚ûï Informa√ß√µes complementares</strong></summary><br />




O que ser√° verificado:

- Ser√° validado se existe uma `QUERY` que exibe os dados corretos nas colunas `nome` e `reproducoes`.

- Ser√° validado se as colunas est√£o ordenadas de forma correta.

</details>


